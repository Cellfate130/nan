<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Rd2roxygen - Convert Rd to roxygen documentation  - Yihui Xie | 谢益辉</title>
    <meta property="og:title" content="Rd2roxygen - Yihui Xie | 谢益辉">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="The package Rd2roxygen helps R package developers who used to write R documentation in the raw LaTeX-like commands but now want to switch their documentation to roxygen2, which is a convenient tool &amp;hellip;">
      <meta property="og:description" content="The package Rd2roxygen helps R package developers who used to write R documentation in the raw LaTeX-like commands but now want to switch their documentation to roxygen2, which is a convenient tool &amp;hellip;">
      
    

    
    
    
    <meta name="twitter:image" content="https://yihui.name/images/logo.png">
    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="rd2roxygen">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.png" alt="Yihui Xie" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/en/about/">About</a></li>
  
  <li><a href="/en/">Blog</a></li>
  
  <li><a href="/cn/about/">关于</a></li>
  
  <li><a href="/cn/">博客</a></li>
  
  

<li class="menu-extra"></li>



<li><a href="https://github.com/yihui/Rd2roxygen/edit/master/vignettes/Rd2roxygen.Rmd" target="_blank">Edit this page</a></li>


<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">License</a></li>


  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Rd2roxygen</h1>
<h1><span class="subtitle">Convert Rd to roxygen documentation</span></h2>

<h3>Yihui Xie / 
2017-06-07</h3>

<hr>


      </header>


 <nav id="TableOfContents">
<ul>
<li><a href="#convert-a-whole-package">Convert a whole package</a></li>
<li><a href="#parse-a-single-rd-file">Parse a single Rd file</a></li>
<li><a href="#roxygenize-and-build-a-package">Roxygenize and build a package</a></li>
<li><a href="#about-this-vignette">About this vignette</a></li>
</ul>
</nav> 


<p>The package <a href="https://github.com/yihui/Rd2roxygen"><strong>Rd2roxygen</strong></a> helps R package developers who
used to write R documentation in the raw LaTeX-like commands but now want to
switch their documentation to <a href="https://cran.rstudio.org/package=roxygen2"><strong>roxygen2</strong></a>, which is a
convenient tool for developers, since we can write documentation as inline
comments, e.g.</p>

<pre><code class="language-r">## the source code of the function `parse_and_save`
ex.file = system.file(&quot;examples&quot;, &quot;parse_and_save.R&quot;, package = &quot;Rd2roxygen&quot;)
cat(readLines(ex.file), sep = &quot;\n&quot;)
</code></pre>

<pre><code>##' Parse the input Rd file and save the roxygen documentation into a file.
##'
##' @param path the path of the Rd file
##' @param file the path to save the roxygen documentation
##' @param usage logical: whether to include the usage section in the output
##' @return a character vector if \code{file} is not specified, or write the vector
##' into a file
##' @export
##' @author Hadley Wickham; modified by Yihui Xie &lt;\url{http://yihui.name}&gt;
parse_and_save &lt;- function(path, file, usage = FALSE) {
  parsed &lt;- parse_file(path)
  output &lt;- create_roxygen(parsed, usage = usage)
  if (missing(file)) output else
    cat(paste(output, collapse = &quot;\n&quot;), file = file)
}
</code></pre>

<p>With <strong>roxygen2</strong> (typically using <code>roxygenize()</code>), we can create the real
Rd file from the above source code like this:</p>

<pre><code class="language-r">rd.file = system.file(&quot;examples&quot;, &quot;parse_and_save.Rd&quot;, package = &quot;Rd2roxygen&quot;)
cat(readLines(rd.file), sep = &quot;\n&quot;)
</code></pre>

<pre><code>\name{parse_and_save}
\alias{parse_and_save}
\title{Parse the input Rd file and save the roxygen documentation into a file.}
\usage{parse_and_save(path, file, usage=FALSE)}
\description{Parse the input Rd file and save the roxygen documentation into a file.}
\value{a character vector if \code{file} is not specified, or write the vector
into a file}
\author{Hadley Wickham; modified by Yihui Xie &lt;\url{http://yihui.name}&gt;}
\arguments{\item{path}{the path of the Rd file}
\item{file}{the path to save the roxygen documentation}
\item{usage}{logical: whether to include the usage section in the output}}
</code></pre>

<p>The <strong>Rd2roxygen</strong> package goes exactly in the <em>opposite</em> way &ndash; it parses
the Rd files and turns them back to roxygen comments. We can either do this
job on single Rd files, or just convert the whole package. The latter might
be more useful for developers who are considering the transition from Rd to
roxygen.</p>

<h1 id="convert-a-whole-package">Convert a whole package</h1>

<p>The function <code>Rd2roxygen::Rd2roxygen()</code> can take a path of a source package, parse all
the Rd files under the <code>man</code> directory, and write the roxygen comments right
above the source code of the functions under the <code>R</code> directory. See
<code>?Rd2roxygen</code> for an example.</p>

<pre><code class="language-r">Rd2roxygen::Rd2roxygen(&quot;path/to/source/pkg&quot;)
## there must be 'man' and 'R' directories under this path
</code></pre>

<p>Note the path to the package should not be <code>.</code>. You are recommended to call this function in the directory that contains the source package.</p>

<h1 id="parse-a-single-rd-file">Parse a single Rd file</h1>

<p>We can parse a single Rd file and create the roxygen comments as well with
<code>parse_file()</code> and <code>create_roxygen()</code>, e.g.</p>

<pre><code class="language-r">library(Rd2roxygen)
## we can specify the roxygen comments prefix (#' by default)
options(roxygen.comment = &quot;##' &quot;)
str(info &lt;- parse_file(rd.file))
</code></pre>

<pre><code>List of 9
 $ title   : chr &quot;Parse the input Rd file and save the roxygen documentation into a file.&quot;
 $ usage   : chr &quot;parse_and_save(path, file, usage=FALSE)&quot;
 $ desc    : chr &quot;Parse the input Rd file and save the roxygen documentation into a file.&quot;
 $ section : chr(0) 
 $ value   : chr &quot;a character vector if \\code{file} is not specified, or write the vector\ninto a file&quot;
 $ author  : chr &quot;Hadley Wickham; modified by Yihui Xie &lt;\\url{http://yihui.name}&gt;&quot;
 $ name    : chr &quot;parse_and_save&quot;
 $ keywords: list()
 $ params  : chr [1:3] &quot;path the path of the Rd file&quot; &quot;file the path to save the roxygen documentation&quot; &quot;usage logical: whether to include the usage section in the output&quot;
</code></pre>

<pre><code class="language-r"># parse_and_save() combines these two steps
cat(create_roxygen(info), sep = &quot;\n&quot;)
</code></pre>

<pre><code>##' Parse the input Rd file and save the roxygen documentation into a file.
##' 
##' Parse the input Rd file and save the roxygen documentation into a file.
##' 
##' 
##' @param path the path of the Rd file
##' @param file the path to save the roxygen documentation
##' @param usage logical: whether to include the usage section in the output
##' @return a character vector if \code{file} is not specified, or write the
##' vector into a file
##' @author Hadley Wickham; modified by Yihui Xie &lt;\url{http://yihui.name}&gt;
</code></pre>

<h1 id="roxygenize-and-build-a-package">Roxygenize and build a package</h1>

<p>This package also provides a tool <code>roxygen_and_build()</code> (or in short <code>rab()</code>)
to help us build the package.</p>

<pre><code class="language-r">rab(pkg, build = TRUE, build.opts = &quot;--no-manual&quot;, install = FALSE, 
  install.opts = if (build) &quot;&quot; else &quot;--with-keep.source&quot;, check = FALSE, 
  check.opts = &quot;--as-cran --no-manual&quot;, remove.check = TRUE, 
  reformat = TRUE, before = NULL, ...)
</code></pre>

<p>The main feature of <code>rab()</code> is the option to &ldquo;reformat&rdquo; the code in the
usage and example sections. If we specify <code>reformat = TRUE</code> in <code>rab()</code>, the
code will be reformated like this:</p>

<pre><code class="language-r">## original code
rab=function(pkg,build=TRUE,install=FALSE,
check=FALSE,check.opts='',remove.check=TRUE,reformat=TRUE,...){}
</code></pre>

<pre><code class="language-r">## the reformatted code; note the spaces and indent
rab = function(pkg, build = TRUE, install = FALSE, check = FALSE, 
  check.opts = &quot;&quot;, remove.check = TRUE, reformat = TRUE, ...) {
}
</code></pre>

<p>Note this functionality depends on the package <a href="https://yihui.name/formatR"><strong>formatR</strong></a>, and
sometimes it might not be possible to reformat the code, e.g. the
<code>\dontrun{}</code> command in Rd can contain arbitrary texts, which means there
could be illegal R expressions and <strong>formatR</strong> will be unable to format the
code. In this case, the original code will not be reformatted and a message
will be printed on screen.</p>

<h1 id="about-this-vignette">About this vignette</h1>

<p>This vignette was built using the vignette engine <code>knitr::rmarkdown</code>
in the <a href="https://yihui.name/knitr"><strong>knitr</strong></a> package. You can find the source
in the <a href="https://github.com/yihui/Rd2roxygen/tree/master/vignettes">Rd2roxygen
repository</a> on
Github, or</p>

<pre><code class="language-r">system.file(&quot;doc&quot;, &quot;Rd2roxygen.Rmd&quot;, package = &quot;Rd2roxygen&quot;)
</code></pre>


  <footer>
  


<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
    this.page.url = "http:\/\/yihui.name" + location.pathname;
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//yihui.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var b = false, l = function() {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
    }
    
    if (location.hash.match(/^#comment/)) return(l());
    var t = d.getElementById('disqus_thread');
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




<script async src="/js/external-link.js"></script>

<script async src="/js/center-img.js"></script>

<script async src="/js/right-quote.js"></script>

<script async src="/js/no-highlight.js"></script>

<script async src="/js/fix-footnote.js"></script>

<script async src="/js/math-code.js"></script>



<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="/">Yihui Xie</a> 2005 - 2018</div>
  
  </footer>
  </article>
  
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-1988641-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

