<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Listings - Using knitr with listings  - Yihui Xie | 谢益辉</title>
    <meta property="og:title" content="Listings - Yihui Xie | 谢益辉">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="It is easy to define your own output hooks in knitr to decorate your results with the LaTeX listings package. Here is a snippet that you may use:
## a common hook for messages, warnings and errors &amp;hellip;">
      <meta property="og:description" content="It is easy to define your own output hooks in knitr to decorate your results with the LaTeX listings package. Here is a snippet that you may use:
## a common hook for messages, warnings and errors &amp;hellip;">
      
    

    
    
    <meta name="twitter:image" content="https://db.yihui.name/imgur/PKupQ.png">
    
    
    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="knitr">
    <header class="masthead">
      

<h1><a href="/knitr/"><img src="/knitr/images/knit-logo.png" alt="knitr logo" /></a></h1>
<p class="tagline">knitr: elegant, flexible, and fast dynamic report generation with R</p>


      <nav class="menu">
  <ul>
  
  
  <li><a href="/knitr/">Home</a></li>
  
  <li><a href="/knitr/options/">Options</a></li>
  
  <li><a href="/knitr/hooks/">Hooks</a></li>
  
  <li><a href="/knitr/demos/">Examples</a></li>
  
  <li><a href="/knitr/faq/">FAQ</a></li>
  
  <li><a href="https://github.com/yihui/knitr">Github repo</a></li>
  
  <li><a href="/">Yihui Xie</a></li>
  
  

<li class="menu-extra"></li>



<li><a href="https://github.com/rbind/yihui/edit/master/content/knitr%5cdemo%5c2011-12-10-listings.md" target="_blank">Edit this page</a></li>


<li><a href="/knitr/index.xml" type="application/rss+xml" title="RSS feed">Subscribe</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">License</a></li>


  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Listings</h1>
<h1><span class="subtitle">Using knitr with listings</span></h2>

<h3>
2011-12-10</h3>

<hr>


      </header>





<p>It is easy to define your own output <a href="../../hooks">hooks</a> in <strong>knitr</strong> to decorate your results with the LaTeX <strong>listings</strong> package. Here is a snippet that you may use:</p>

<pre><code class="language-r">## a common hook for messages, warnings and errors
hook_lst_bf = function(x, options) {
    paste(&quot;\\begin{lstlisting}[basicstyle={\\bfseries}]\n&quot;, x, 
        &quot;\\end{lstlisting}\n&quot;, sep = &quot;&quot;)
}
knit_hooks$set(source = function(x, options) {
    paste(&quot;\\begin{lstlisting}[language=R,numbers=left,stepnumber=2]\n&quot;, x, 
        &quot;\\end{lstlisting}\n&quot;, sep = &quot;&quot;)
}, output = function(x, options) {
    paste(&quot;\\begin{lstlisting}[basicstyle={\\ttfamily}]\n&quot;, x, 
        &quot;\\end{lstlisting}\n&quot;, sep = &quot;&quot;)
}, warning = hook_lst_bf, message = hook_lst_bf, error = hook_lst_bf)

## empty highlight header since it is not useful any more
set_header(highlight = &quot;&quot;)
</code></pre>

<p>As you can see, <strong>knitr</strong> exposes everything to the user. All you need to do is to make sure that these pieces R source and output can be wrapped in proper environments.</p>

<p>Wait, do not copy the code above, because I have already made them into <strong>knitr</strong> via the function <code>render_listings()</code> with a few tweaks. Here is an example:</p>

<ul>
<li>Using <strong>knitr</strong> with listings

<ul>
<li>Rnw source: <a href="https://github.com/yihui/knitr/blob/master/inst/examples/knitr-listings.Rnw">knitr-listings.Rnw</a></li>
<li>LyX source: <a href="https://github.com/yihui/knitr/blob/master/inst/examples/knitr-listings.lyx">knitr-listings.lyx</a></li>
<li>PDF output: <a href="https://github.com/yihui/knitr/releases/download/doc/knitr-listings.pdf">knitr-listings.pdf</a></li>
</ul></li>
</ul>

<p>One screenshot from the PDF output:</p>

<p><img src="https://db.yihui.name/imgur/PKupQ.png" alt="using listings in knitr" /></p>

<p>I thank Frank Harrell for the LaTeX style file <code>Sweavel.sty</code>.</p>

<h2 id="more-listings-options">More listings options</h2>

<p>The <strong>listings</strong> package has tons of options that you can use, so be sure to read its manual to know its full power. Below is an example to show how to break lines in the error messages, and you can download its <a href="https://gist.github.com/2209775">the Rnw source</a>. The key is the option <code>breaklines=true</code>.</p>

<p><img src="https://db.yihui.name/imgur/3313T.png" alt="break lines in listings output" /></p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/knitr/demo/graphics/">Graphics</a></span>
  <span class="nav-next"><a href="/knitr/demo/reference/">Chunk Reference/Macro</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/knitr\/demo\/graphics\/';
    
  } else if (e.which == 39) {  
    
    url = '\/knitr\/demo\/reference\/';
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
    this.page.url = "http:\/\/yihui.name" + location.pathname;
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//yihui.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var b = false, l = function() {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
    }
    
    if (location.hash.match(/^#comment/)) return(l());
    var t = d.getElementById('disqus_thread');
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




<script async src="/js/external-link.js"></script>

<script async src="/js/center-img.js"></script>

<script async src="/js/right-quote.js"></script>

<script async src="/js/no-highlight.js"></script>

<script async src="/js/fix-footnote.js"></script>

<script async src="/js/math-code.js"></script>



<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="/">Yihui Xie</a> 2005 - 2018</div>
  
  </footer>
  </article>
  
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-1988641-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

